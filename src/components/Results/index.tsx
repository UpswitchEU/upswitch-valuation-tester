import React from 'react';
import { useValuationStore } from '../../store/useValuationStore';

/**
 * Results Component - Displays Accountant View HTML Report
 * 
 * Shows the professional HTML report generated by the Python backend.
 * All detailed React components have been moved to the Info tab.
 */
export const Results: React.FC = () => {
  const { result } = useValuationStore();

  if (!result) {
    return null;
  }

  // If html_report is not available, show loading/error
  if (!result.html_report) {
    return (
      <div className="flex items-center justify-center h-full min-h-[400px]">
        <div className="text-center text-gray-500">
          <svg className="w-16 h-16 mx-auto mb-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg>
          <p className="font-medium">Report not available</p>
          <p className="text-sm text-gray-400 mt-1">HTML report was not generated by backend</p>
        </div>
      </div>
    );
  }

  return (
    <div className="h-full overflow-y-auto bg-white">
      <style>{`
        .accountant-view-report {
          font-family: 'Times New Roman', Times, serif;
          line-height: 1.6;
          color: #000;
          background: #fff;
          padding: 2rem;
          max-width: 8.5in;
          margin: 0 auto;
        }

        .accountant-view-report h1,
        .accountant-view-report h2,
        .accountant-view-report h3 {
          page-break-after: avoid;
        }

        .accountant-view-report table {
          page-break-inside: avoid;
          width: 100%;
          border-collapse: collapse;
          margin: 1rem 0;
        }

        .accountant-view-report th,
        .accountant-view-report td {
          border: 1px solid #ddd;
          padding: 8px;
          text-align: left;
        }

        .accountant-view-report th {
          background-color: #f5f5f5;
          font-weight: bold;
        }

        @media print {
          .accountant-view-report {
            padding: 0;
            max-width: 100%;
          }
        }
      `}</style>
      <div
        className="accountant-view-report"
        dangerouslySetInnerHTML={{ __html: result.html_report }}
      />
    </div>
  );
};

// Export individual components for Info tab usage
export { ResultsHeader } from './ResultsHeader';
export { ValuationWaterfall } from './ValuationWaterfall';
export { OwnerConcentrationSummaryCard } from './OwnerConcentrationSummaryCard';
export { OwnershipAdjustments } from './OwnershipAdjustments';
export { OwnerConcentrationAnalysis } from './OwnerConcentrationAnalysis';
export { CalculationJourneyOverview } from './CalculationJourneyOverview';
export { AdjustmentsSummary } from './AdjustmentsSummary';
export { DataQualityConfidence } from './DataQualityConfidence';
export { MethodologyBreakdown } from './MethodologyBreakdown';
export { GrowthMetrics } from './GrowthMetrics';
export { ValueDrivers } from './ValueDrivers';
export { RiskFactors } from './RiskFactors';
export { CompetitiveComparison } from './CompetitiveComparison';
export { MultipleWaterfall } from './MultipleWaterfall';
