"use strict";exports.id=791,exports.ids=[791],exports.modules={34791:(e,a,l)=>{l.r(a),l.d(a,{ValuationFlow:()=>x});var n=l(10326),o=l(17577),s=l(97810),t=l(45055),i=l(33741);let d=(0,o.lazy)(()=>l.e(979).then(l.bind(l,64979)).then(e=>({default:e.Results}))),r=(0,o.lazy)(()=>l.e(105).then(l.bind(l,29105)).then(e=>({default:e.StreamingChat}))),c=(0,o.lazy)(()=>l.e(638).then(l.bind(l,49638)).then(e=>({default:e.ValuationToolbar}))),u=(0,o.lazy)(()=>l.e(118).then(l.bind(l,14118)).then(e=>({default:e.DataCollection}))),m=({message:e="Loading..."})=>n.jsx("div",{className:"flex items-center justify-center p-8",children:(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600"}),n.jsx("span",{className:"text-zinc-600",children:e})]})}),x=({reportId:e,flowType:a,onComplete:l,initialQuery:o=null,autoSend:s=!1})=>"conversational"===a?n.jsx(h,{reportId:e,onComplete:l,initialQuery:o,autoSend:s}):n.jsx(f,{reportId:e,onComplete:l}),f=({reportId:e,onComplete:a})=>{let{result:r,isCalculating:x,calculateValuation:f,setCollectedData:h}=(0,t.useValuationStore)(),{user:p}=(0,s.a)(),v=(0,o.useCallback)(e=>{h(e)},[h]),b=(0,o.useCallback)(async a=>{h(a);try{await f()}catch(a){i.a.error("Valuation calculation failed",{error:a,reportId:e})}},[h,f,e]),j=(0,o.useCallback)(e=>{i.a.debug("Manual flow progress update",{progress:e.overallProgress,completedFields:e.completedFields,totalFields:e.totalFields})},[]);return(0,n.jsxs)("div",{className:"h-full flex flex-col",children:[n.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:n.jsx(o.Suspense,{fallback:n.jsx(m,{message:"Loading data collection..."}),children:n.jsx(u,{method:"manual_form",onDataCollected:v,onProgressUpdate:j,onComplete:b})})}),n.jsx(o.Suspense,{fallback:n.jsx(m,{message:"Loading toolbar..."}),children:n.jsx(c,{onRefresh:()=>window.location.reload(),onDownload:async()=>{if(r)try{let{DownloadService:e}=await l.e(887).then(l.bind(l,12887));await e.downloadPDF(r,{format:"pdf",filename:`valuation-${Date.now()}.pdf`})}catch(a){i.a.error("PDF download failed",{error:a,reportId:e})}},onFullScreen:()=>{},isGenerating:x,user:p,valuationName:"Manual Valuation",valuationId:r?.valuation_id,activeTab:"preview",onTabChange:()=>{}})}),r&&n.jsx("div",{className:"border-t border-gray-200",children:n.jsx(o.Suspense,{fallback:n.jsx(m,{message:"Loading results..."}),children:n.jsx(d,{})})})]})};f.displayName="ManualFlow",x.displayName="ValuationFlow";let h=({reportId:e,onComplete:a,initialQuery:l=null,autoSend:t=!1})=>{let{user:d}=(0,s.a)(),u=(0,o.useCallback)(e=>{a(e)},[a]);return(0,n.jsxs)("div",{className:"h-full flex flex-col",children:[n.jsx(o.Suspense,{fallback:n.jsx(m,{message:"Loading toolbar..."}),children:n.jsx(c,{onRefresh:()=>window.location.reload(),onDownload:async()=>{console.log("PDF download not yet implemented for conversational flow")},onFullScreen:()=>{},isGenerating:!1,user:d,valuationName:"Conversational Valuation",valuationId:void 0,activeTab:"preview",onTabChange:()=>{}})}),n.jsx("div",{className:"flex-1 overflow-hidden",children:n.jsx(o.Suspense,{fallback:n.jsx(m,{message:"Loading chat..."}),children:n.jsx(r,{sessionId:e,userId:d?.id,onValuationComplete:u,onValuationStart:()=>{i.a.info("Conversational valuation started",{reportId:e})},initialMessage:l,autoSend:t})})})]})};h.displayName="ConversationalFlow"}};