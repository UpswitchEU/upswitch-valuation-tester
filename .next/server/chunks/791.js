"use strict";exports.id=791,exports.ids=[791],exports.modules={50732:(e,t,a)=>{a.d(t,{Z:()=>s});/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(62881).Z)("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]])},30361:(e,t,a)=>{a.d(t,{Z:()=>s});/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(62881).Z)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},92498:(e,t,a)=>{a.d(t,{Z:()=>s});/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(62881).Z)("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]])},36283:(e,t,a)=>{a.d(t,{Z:()=>s});/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(62881).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},18019:(e,t,a)=>{a.d(t,{Z:()=>s});/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(62881).Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},82685:(e,t,a)=>{a.d(t,{Z:()=>s});/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(62881).Z)("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]])},1572:(e,t,a)=>{a.d(t,{Z:()=>s});/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(62881).Z)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]])},50949:(e,t,a)=>{a.d(t,{Z:()=>s});/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(62881).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},70118:(e,t,a)=>{a.d(t,{w:()=>m});var s=a(10326),r=a(62881);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r.Z)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]),l=(0,r.Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),i=(0,r.Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),o=(0,r.Z)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var c=a(18019);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,r.Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var u=a(17577);let m=({user:e,onLogout:t})=>{let[a,r]=(0,u.useState)(!1),m=(0,u.useRef)(null),p=(0,u.useRef)(null),[x,h]=(0,u.useState)({top:0,right:0});(0,u.useEffect)(()=>{if(a&&p.current){let e=p.current.getBoundingClientRect();h({top:e.bottom+8,right:window.innerWidth-e.right})}},[a]),(0,u.useEffect)(()=>{let e=e=>{m.current&&!m.current.contains(e.target)&&r(!1)};return a&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[a]),(0,u.useEffect)(()=>{let e=e=>{"Escape"===e.key&&a&&r(!1)};return a&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[a]);let g=()=>{if(!e?.name)return"?";let t=e.name.split(" ");return t.length>=2?`${t[0][0]}${t[1][0]}`.toUpperCase():e.name.substring(0,2).toUpperCase()},y=e?.avatar_url||e?.avatar,f=!!y,b=async()=>{r(!1),await t()},v=[{key:"create-account",icon:o,label:"Create Account",action:()=>{r(!1),window.parent&&window.parent!==window?window.parent.postMessage({type:"OPEN_SIGNUP"},"*"):window.open("https://upswitch.biz/signup","_blank")}},{key:"divider-1",isDivider:!0},{key:"learn-more",icon:c.Z,label:"Learn More",action:()=>{r(!1),window.parent&&window.parent!==window?window.parent.postMessage({type:"NAVIGATE_TO_VALUATION"},"*"):window.open("https://upswitch.biz/valuation","_blank")}}],w=e?[{key:"back-to-dashboard",icon:n,label:"Back to Dashboard",action:()=>{r(!1),window.parent&&window.parent!==window?window.parent.postMessage({type:"NAVIGATE_TO_DASHBOARD"},"*"):window.open("https://upswitch.biz/my-business","_blank")}},{key:"account-settings",icon:l,label:"Account Settings",action:()=>{r(!1),window.parent&&window.parent!==window?window.parent.postMessage({type:"NAVIGATE_TO_SETTINGS"},"*"):window.open("https://upswitch.biz/users/profile","_blank")}},{key:"divider-1",isDivider:!0},{key:"logout",icon:i,label:"Log Out",action:b}]:v;return(0,s.jsxs)("div",{ref:m,className:"relative",style:{zIndex:100},children:[s.jsx("button",{ref:p,onClick:()=>{r(e=>!e)},className:"flex items-center justify-center w-10 h-10 sm:w-8 sm:h-8 rounded-full bg-gray-200 text-gray-700 text-sm font-medium hover:bg-gray-300 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2","aria-label":e?`${e.name||e.email} - Account Menu`:"Guest - Account Menu","aria-expanded":a,"aria-haspopup":"true",style:{position:"relative",zIndex:101},children:e?(0,s.jsxs)(s.Fragment,{children:[f?s.jsx("img",{src:y||"",alt:e?.name||"User",className:"w-full h-full rounded-full object-cover",loading:"lazy",onError:e=>{e.currentTarget.style.display="none",e.currentTarget.nextElementSibling?.classList.remove("hidden")}}):null,s.jsx("span",{className:f?"hidden":"block",children:g()})]}):s.jsx(d,{className:"w-4 h-4 text-gray-600"})}),a&&(0,s.jsxs)(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-[9998]",onClick:()=>r(!1),"aria-hidden":"true"}),(0,s.jsxs)("div",{className:"fixed w-56 bg-zinc-900 rounded-lg shadow-lg border border-zinc-800 py-2 z-[9999]",style:{top:`${x.top}px`,right:`${x.right}px`},children:[s.jsx("div",{className:"px-4 py-3 border-b border-zinc-800",children:e?(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("div",{className:"w-8 h-8 bg-zinc-700 rounded-full flex items-center justify-center flex-shrink-0",children:[f?s.jsx("img",{src:y||"",alt:e?.name||"User",className:"w-full h-full rounded-full object-cover",loading:"lazy",onError:e=>{e.currentTarget.style.display="none",e.currentTarget.nextElementSibling?.classList.remove("hidden")}}):null,s.jsx("span",{className:f?"hidden":"block text-white text-sm font-medium",children:g()})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"text-sm font-medium text-white truncate",children:e.name||"User"}),s.jsx("div",{className:"text-xs text-zinc-400 truncate",children:e.email})]})]}):(0,s.jsxs)("div",{className:"flex flex-col",children:[s.jsx("p",{className:"text-sm font-medium text-white",children:"Welcome, Guest"}),s.jsx("p",{className:"text-xs text-zinc-400",children:"Sign in to access your dashboard"})]})}),s.jsx("div",{className:"py-2",children:w.map((e,t)=>{if(e.isDivider)return s.jsx("div",{className:"h-px bg-zinc-800 my-1",role:"separator"},t);let a=e.icon,r=0===t,n=t===w.length-1,l="logout"===e.key;return(0,s.jsxs)("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),e.action?.()},className:`
                      w-full flex items-center gap-3 px-4 py-4 sm:py-3 text-base sm:text-sm font-medium text-left border-0 bg-transparent
                      transition-colors duration-150
                      ${r?"rounded-t-xl":""}
                      ${n?"rounded-b-xl":""}
                      ${l?"hover:bg-red-900/20 text-red-400 hover:text-red-300":"hover:bg-zinc-800/50 text-zinc-300 hover:text-white"}
                    `,role:"menuitem",tabIndex:0,children:[a&&s.jsx(a,{className:`w-5 h-5 sm:w-4 sm:h-4 flex-shrink-0 ${l?"text-red-400":"text-zinc-400"}`}),s.jsx("span",{className:"flex-1",children:e.label})]},t)})})]})]})]})}},27048:(e,t,a)=>{a.d(t,{x:()=>k});var s=a(10326),r=a(77506),n=a(82685),l=a(62881);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,l.Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),o=(0,l.Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var c=a(92498),d=a(18019);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,l.Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),m=(0,l.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),p=(0,l.Z)("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);var x=a(17577),h=a(97810),g=a(31989),y=a(33741);class f{static{this.GUEST_REPORT_COUNT_KEY="upswitch_guest_report_count"}static getNextGuestReportNumber(){try{let e=localStorage.getItem(this.GUEST_REPORT_COUNT_KEY),t=(e?parseInt(e,10):0)+1;return localStorage.setItem(this.GUEST_REPORT_COUNT_KEY,t.toString()),t}catch(e){return console.warn("Failed to access localStorage for report count:",e),1}}static generateValuationName(e){if(!localStorage.getItem("upswitch_user_id")&&!localStorage.getItem("upswitch_auth_token")){let e=this.getNextGuestReportNumber();return`Valuation Report #${e}`}let t=0,a=e||Date.now().toString();for(let e=0;e<a.length;e++)t+=a.charCodeAt(e)*(e+1);let s=t%900+100;return`Valuation Report #${s}`}static generateFromCompany(e){if(!e)return this.generateValuationName();let t=e.trim().split(" ").slice(0,2).join(" ").substring(0,20),a=0;for(let t=0;t<e.length;t++)a+=e.charCodeAt(t)*(t+1);let s=a%900+100;return`${t} Valuation #${s}`}static generateWithDate(e){let t=new Date,a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()],s=t.getDate();return e?`${e} ${a}-${s}`:`Valuation Report ${a}-${s}`}}var b=a(50949),v=a(60962);let w=({isOpen:e,onClose:t,onConfirm:a,targetFlow:r,currentFlow:n})=>{if(!e)return null;let l={manual:"Manual Entry",conversational:"AI-Guided"},i="conversational"===r?"Conversational":"Manual",o=n?l[n]:null,c=(0,s.jsxs)("div",{className:"fixed inset-0 z-50",children:[s.jsx("div",{className:"absolute inset-0 bg-black/65",onClick:t,"aria-hidden":"false"}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4","aria-hidden":"false","aria-modal":"true",role:"dialog",children:(0,s.jsxs)("div",{className:"bg-zinc-800 rounded-2xl shadow-2xl border border-zinc-700 max-w-md w-full",onClick:e=>e.stopPropagation(),children:[s.jsx("div",{className:"px-6 py-5 border-b border-zinc-700",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-primary-500/10 flex items-center justify-center",children:s.jsx(b.Z,{className:"w-5 h-5 text-primary-500"})}),(0,s.jsxs)("h2",{className:"text-xl font-semibold text-white",children:["Switch to ",i," Flow?"]})]})}),(0,s.jsxs)("div",{className:"px-6 py-5 space-y-3",children:[s.jsx("p",{className:"text-zinc-300 leading-relaxed",children:o?(0,s.jsxs)(s.Fragment,{children:["Switch from ",s.jsx("span",{className:"font-semibold text-white",children:o})," to"," ",s.jsx("span",{className:"font-semibold text-white",children:l[r]}),"?"]}):(0,s.jsxs)(s.Fragment,{children:["Switch to the ",i.toLowerCase()," flow?"]})}),s.jsx("p",{className:"text-zinc-400 text-sm leading-relaxed",children:"Your entered data will be preserved. You can switch between flows at any time without losing your progress."})]}),(0,s.jsxs)("div",{className:"px-6 py-4 bg-zinc-900/50 rounded-b-2xl flex items-center justify-end gap-3",children:[s.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-zinc-300 hover:text-white transition-colors",children:"Cancel"}),s.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium bg-accent-600 hover:bg-accent-500 text-white rounded-lg transition-colors",children:"Switch Flow"})]})]})})]});return"undefined"!=typeof document&&document.body?(0,v.createPortal)(c,document.body):c};var j=a(70118);let N=({content:e,children:t,position:a="top",delay:r=300,className:n="cursor-help border-b border-dotted border-gray-400"})=>{let[l,i]=(0,x.useState)(!1),[o,c]=(0,x.useState)(!1),[d,u]=(0,x.useState)(null),m=(0,x.useRef)(null),p=(0,x.useRef)(null);return(0,x.useEffect)(()=>{c("ontouchstart"in window)},[]),(0,x.useEffect)(()=>{if(!o||!l)return;let e=e=>{m.current&&!m.current.contains(e.target)&&p.current&&!p.current.contains(e.target)&&i(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[o,l]),(0,x.useEffect)(()=>()=>{d&&clearTimeout(d)},[d]),(0,s.jsxs)("div",{className:"relative inline-block",children:[s.jsx("div",{ref:p,role:"tooltip","aria-label":e,onClick:e=>{o&&(e.preventDefault(),e.stopPropagation(),i(!l))},onMouseEnter:o?void 0:()=>{o||u(setTimeout(()=>i(!0),r))},onMouseLeave:o?void 0:()=>{d&&(clearTimeout(d),u(null)),i(!1)},onFocus:()=>i(!0),onBlur:()=>i(!1),tabIndex:0,className:n,children:t}),l&&(0,s.jsxs)("div",{ref:m,className:`absolute z-50 px-3 py-2 text-sm text-white bg-gray-900 
            rounded-lg shadow-lg whitespace-nowrap transition-opacity duration-200
            ${"top"===a?"bottom-full mb-2 left-1/2 -translate-x-1/2":""}
            ${"bottom"===a?"top-full mt-2 left-1/2 -translate-x-1/2":""}
          `,children:[e,s.jsx("div",{className:`absolute w-2 h-2 bg-gray-900 rotate-45
            ${"top"===a?"bottom-[-4px] left-1/2 -translate-x-1/2":""}
            ${"bottom"===a?"top-[-4px] left-1/2 -translate-x-1/2":""}
          `})]})]})},k=({onRefresh:e,onDownload:t,onFullScreen:a,isGenerating:l=!1,user:b,valuationName:v="Valuation test123",activeTab:k="preview",onTabChange:z,companyName:C})=>{let{refreshAuth:M}=(0,h.a)(),{session:_,switchView:S,pendingFlowSwitch:E,setPendingFlowSwitch:F,isSyncing:L}=(0,g.L)(),[T,$]=(0,x.useState)(!1);(0,x.useEffect)(()=>{E?$(!0):$(!1)},[E]);let D=async e=>{if(!_||_.currentView===e)return;let t=await S(e,!1,!1);t?.needsConfirmation&&$(!0)},A=async()=>{E&&(await S(E,!1,!0),$(!1),F(null))},[Z,I]=(0,x.useState)(!1),[V,q]=(0,x.useState)(v),[R,P]=(0,x.useState)(()=>C?f.generateFromCompany(C):f.generateValuationName()),U=(0,x.useRef)(null);(0,x.useEffect)(()=>{Z&&U.current&&(U.current.focus(),U.current.select())},[Z]),(0,x.useEffect)(()=>{Z||q(R)},[R,Z]);let O=()=>{I(!0)},B=async()=>{if(!V.trim()){q(v),I(!1);return}P(V.trim()),I(!1);try{y.a.info("Valuation name saved",{name:V.trim()})}catch(e){y.a.error("Failed to save valuation name",{error:e})}},H=()=>{q(v),I(!1)},G=e=>{z?.(e)},K=async()=>{try{y.a.info("Logging out user");let e=(void 0).VITE_BACKEND_URL||(void 0).VITE_API_BASE_URL||"https://web-production-8d00b.up.railway.app",t=await fetch(`${e}/api/auth/logout`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}});t.ok?y.a.info("Logout successful"):y.a.warn("Logout request failed",{status:t.status}),await M()}catch(e){y.a.error("Logout failed",{error:e}),await M()}};return(0,s.jsxs)(s.Fragment,{children:[s.jsx("nav",{className:"relative min-h-12 w-full shrink-0 flex items-center gap-2 px-4 py-2 border-b border-zinc-800/50 bg-zinc-950/50 backdrop-blur-sm overflow-visible",children:s.jsx("div",{className:"relative max-w-full gap-1 flex w-full shrink-0 items-center",children:s.jsx("div",{className:"w-full overflow-visible whitespace-nowrap scrollbar-hide",children:(0,s.jsxs)("div",{className:"relative flex w-full flex-shrink-0 items-center justify-between",children:[s.jsx("div",{className:"flex flex-shrink-0 items-center gap-2",style:{width:"23%"},children:(0,s.jsxs)("div",{className:"relative flex items-center gap-2 group",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-white",children:[l?s.jsx(r.Z,{className:"w-4 h-4 animate-spin text-white"}):s.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-harvest-500 to-harvest-600 animate-pulse shadow-[0_0_8px_rgba(217,165,88,0.5)]"}),Z?s.jsx("input",{ref:U,type:"text",value:V,onChange:e=>q(e.target.value),onBlur:B,onKeyDown:e=>{"Enter"===e.key?B():"Escape"===e.key&&H()},className:"bg-transparent border-none outline-none focus:outline-none focus:ring-0 focus:border-none text-transparent bg-clip-text bg-gradient-to-r from-harvest-400 to-harvest-500 font-semibold text-sm",style:{minWidth:"120px"}}):s.jsx("button",{onClick:O,className:"hidden md:block font-semibold text-transparent bg-clip-text bg-gradient-to-r from-harvest-400 to-harvest-500 hover:from-harvest-300 hover:to-harvest-400 transition-all duration-200 cursor-pointer hover:scale-105 drop-shadow-[0_1px_3px_rgba(217,165,88,0.4)]",title:"Click to edit valuation name",children:R}),s.jsx("button",{onClick:O,className:"md:hidden text-xs text-harvest-400 font-bold hover:text-harvest-300 transition-colors cursor-pointer",title:"Click to edit valuation name",children:"Valuation"})]}),s.jsx("div",{className:"hidden md:block text-xs text-zinc-500 opacity-0 group-hover:opacity-100 transition-opacity",children:"✏️"})]})}),(0,s.jsxs)("div",{className:"absolute left-1/2 transform -translate-x-1/2 flex items-center gap-1",children:[s.jsx(N,{content:"Manual Input",position:"bottom",className:"",children:s.jsx("button",{onClick:()=>D("manual"),disabled:_?.currentView==="manual"||L,className:`p-2 rounded-lg transition-all duration-200 ${_?.currentView==="manual"?"bg-zinc-700 text-white":"text-gray-400 hover:text-gray-300 hover:bg-zinc-800"} ${L?"opacity-50 cursor-not-allowed":""}`,children:L&&_?.currentView!=="manual"?s.jsx(r.Z,{className:"w-4 h-4 animate-spin"}):s.jsx(n.Z,{className:"w-4 h-4"})})}),s.jsx(N,{content:"Conversational Mode",position:"bottom",className:"",children:s.jsx("button",{onClick:()=>D("conversational"),disabled:_?.currentView==="conversational"||L,className:`p-2 rounded-lg transition-all duration-200 ${_?.currentView==="conversational"?"bg-zinc-700 text-white":"text-gray-400 hover:text-gray-300 hover:bg-zinc-800"} ${L?"opacity-50 cursor-not-allowed":""}`,children:L&&_?.currentView!=="conversational"?s.jsx(r.Z,{className:"w-4 h-4 animate-spin"}):s.jsx(i,{className:"w-4 h-4"})})}),s.jsx("div",{className:"mx-2 h-6 w-px bg-zinc-700"}),s.jsx(N,{content:"Preview",position:"bottom",className:"",children:s.jsx("button",{onClick:()=>G("preview"),className:`p-2 rounded-lg transition-all duration-200 ${"preview"===k?"bg-zinc-700 text-white":"text-gray-400 hover:text-gray-300 hover:bg-zinc-800"}`,children:s.jsx(o,{className:"w-4 h-4"})})}),s.jsx(N,{content:"Source Code",position:"bottom",className:"",children:s.jsx("button",{onClick:()=>G("source"),className:`p-2 rounded-lg transition-all duration-200 ${"source"===k?"bg-zinc-700 text-white":"text-gray-400 hover:text-gray-300 hover:bg-zinc-800"}`,children:s.jsx(c.Z,{className:"w-4 h-4"})})}),s.jsx(N,{content:"Valuation Info",position:"bottom",className:"",children:s.jsx("button",{onClick:()=>G("info"),className:`p-2 rounded-lg transition-all duration-200 ${"info"===k?"bg-zinc-700 text-white":"text-gray-400 hover:text-gray-300 hover:bg-zinc-800"}`,children:s.jsx(d.Z,{className:"w-4 h-4"})})}),s.jsx("div",{className:"mx-2 h-6 w-px bg-zinc-700"}),s.jsx(N,{content:"Refresh",position:"bottom",className:"",children:s.jsx("button",{onClick:e,className:"p-2 rounded-lg transition-all duration-200 text-gray-400 hover:text-gray-300 hover:bg-zinc-800",disabled:l,children:s.jsx(u,{className:"w-4 h-4"})})}),s.jsx(N,{content:"Download PDF",position:"bottom",className:"",children:s.jsx("button",{onClick:t,className:"p-2 rounded-lg transition-all duration-200 text-gray-400 hover:text-gray-300 hover:bg-zinc-800",children:s.jsx(m,{className:"w-4 h-4"})})}),s.jsx(N,{content:"Open Full Screen",position:"bottom",className:"",children:s.jsx("button",{onClick:a,className:"p-2 rounded-lg transition-all duration-200 text-gray-400 hover:text-gray-300 hover:bg-zinc-800",children:s.jsx(p,{className:"w-4 h-4"})})})]}),s.jsx("div",{className:"flex items-center gap-1.5",children:s.jsx("div",{className:"flex items-center gap-3",children:s.jsx(j.w,{user:b,onLogout:K})})})]})})})}),s.jsx(w,{isOpen:T,currentFlow:_?.currentView||"manual",targetFlow:E||"manual",onConfirm:A,onClose:()=>{$(!1),F(null)}})]})}},14118:(e,t,a)=>{a.d(t,{hK:()=>C});let s={company_name:{id:"company_name",label:"Company Name",description:"The legal name of your business",type:"text",required:!0,validation:[{type:"required",message:"Company name is required",severity:"error"},{type:"custom",value:e=>e.length>=2&&e.length<=100,message:"Company name must be between 2 and 100 characters",severity:"error"}],placeholder:"Enter your company name",suggestions:["TechCorp Inc.","Green Energy Solutions","Consulting Partners","Manufacturing Ltd"],priority:1,collectionMethods:["manual_form","conversational","suggestion"]},country_code:{id:"country_code",label:"Country",description:"Where is your business headquartered?",type:"select",required:!0,options:[{value:"BE",label:"Belgium"},{value:"NL",label:"Netherlands"},{value:"DE",label:"Germany"},{value:"FR",label:"France"},{value:"US",label:"United States"},{value:"GB",label:"United Kingdom"}],priority:2,collectionMethods:["manual_form","conversational","suggestion"]},industry:{id:"industry",label:"Industry",description:"What industry does your business operate in?",type:"select",required:!0,options:[{value:"technology",label:"Technology"},{value:"manufacturing",label:"Manufacturing"},{value:"retail",label:"Retail"},{value:"services",label:"Services"},{value:"healthcare",label:"Healthcare"},{value:"finance",label:"Finance"}],priority:3,collectionMethods:["manual_form","conversational","fuzzy_search","suggestion"]},business_model:{id:"business_model",label:"Business Model",description:"How does your business generate revenue?",type:"select",required:!0,dependsOn:["industry"],options:[{value:"b2b_saas",label:"B2B SaaS"},{value:"b2c",label:"B2C"},{value:"marketplace",label:"Marketplace"},{value:"ecommerce",label:"E-commerce"},{value:"manufacturing",label:"Manufacturing"},{value:"services",label:"Services"}],priority:4,collectionMethods:["manual_form","conversational","suggestion"]},founding_year:{id:"founding_year",label:"Founding Year",description:"When was your business founded?",type:"number",required:!0,validation:[{type:"min",value:1900,message:"Founding year must be after 1900",severity:"error"},{type:"max",value:new Date().getFullYear(),message:"Founding year cannot be in the future",severity:"error"}],placeholder:"e.g., 2020",priority:5,collectionMethods:["manual_form","conversational"]},current_year_data:{id:"current_year_data",label:"Current Year Financials",group:"financial",type:"currency",required:!0,priority:6,collectionMethods:["manual_form","conversational"]},revenue:{id:"revenue",label:"Annual Revenue",description:"Total revenue for the most recent complete year",group:"financial",type:"currency",required:!1,validation:[{type:"min",value:0,message:"Revenue cannot be negative",severity:"error"},{type:"max",value:1e9,message:"Please contact us for valuations over €1B",severity:"warning"}],placeholder:"€500,000",suggestions:["Under €100K","€100K - €500K","€500K - €1M","€1M - €5M","Over €5M"],priority:7,collectionMethods:["manual_form","conversational","suggestion"]},ebitda:{id:"ebitda",label:"EBITDA",description:"Earnings Before Interest, Taxes, Depreciation, and Amortization",group:"financial",type:"currency",required:!1,placeholder:"€150,000",priority:8,collectionMethods:["manual_form","conversational"]},number_of_employees:{id:"number_of_employees",label:"Number of Employees",description:"Total full-time equivalent employees",type:"number",required:!1,validation:[{type:"min",value:0,message:"Employee count cannot be negative",severity:"error"},{type:"max",value:1e4,message:"For companies with 10,000+ employees, please contact us",severity:"warning"}],placeholder:"25",suggestions:["1-5","6-20","21-50","51-100","100+"],priority:9,collectionMethods:["manual_form","conversational","suggestion"]}};var r=a(10326),n=a(17577),l=a(50732),i=a(62881);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,i.Z)("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),c=({field:e,value:t,onChange:a,errors:s=[],context:i,disabled:c=!1})=>{let[u,m]=(0,n.useState)(!1),p=s.length>0,x=e=>{a(e,"conversational")},h=function(e){switch(e.id){case"company_name":return"What's the name of your business?";case"revenue":return"What's your annual revenue for the most recent year?";case"ebitda":return"What's your EBITDA (Earnings Before Interest, Taxes, Depreciation, and Amortization)?";case"number_of_employees":return"How many employees does your business have?";case"industry":return"What industry is your business in?";case"country_code":return"Where is your business headquartered?";default:return`What's your ${e.label.toLowerCase()}?`}}(e),g=function(e){switch(e.id){case"company_name":return["TechCorp Inc.","Green Energy Solutions"];case"revenue":return["€500,000","\xa32.3 million","$1.2M"];case"number_of_employees":return["25","5-10 team"];default:return[]}}(e),y=e.suggestions||[];return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-8 h-8 bg-primary-600 rounded-full flex items-center justify-center",children:r.jsx(l.Z,{className:"w-4 h-4 text-white"})}),(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("h3",{className:"text-sm font-medium text-white",children:"Valuation Assistant"}),(0,r.jsxs)("p",{className:"text-xs text-zinc-400",children:["Asking for ",e.label.toLowerCase()]})]}),e.description&&r.jsx("button",{onClick:()=>m(!u),className:"text-zinc-400 hover:text-zinc-300",children:r.jsx(o,{className:"w-4 h-4"})})]}),(0,r.jsxs)("div",{className:"bg-zinc-800/50 rounded-lg p-4 border border-zinc-700/50",children:[r.jsx("p",{className:"text-white text-sm leading-relaxed",children:h}),u&&e.description&&r.jsx("div",{className:"mt-3 pt-3 border-t border-zinc-600/50",children:(0,r.jsxs)("p",{className:"text-xs text-zinc-400",children:["\uD83D\uDCA1 ",e.description]})}),g.length>0&&(0,r.jsxs)("div",{className:"mt-3",children:[r.jsx("p",{className:"text-xs text-zinc-500 mb-2",children:"Examples:"}),r.jsx("div",{className:"flex flex-wrap gap-1",children:g.slice(0,3).map((t,a)=>r.jsx("button",{onClick:()=>x(d(t,e)),disabled:c,className:"px-2 py-1 bg-zinc-700/50 hover:bg-zinc-600/50 text-xs text-zinc-300 rounded border border-zinc-600/50 hover:border-zinc-500/50 transition-colors",children:t},a))})]})]}),y.length>0&&(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Quick suggestions:"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:y.map((t,a)=>r.jsx("button",{onClick:()=>x(d(t,e)),disabled:c,className:"px-3 py-2 bg-primary-600/20 hover:bg-primary-600/30 text-sm text-primary-300 rounded-lg border border-primary-600/30 hover:border-primary-600/50 transition-colors",children:t},a))})]}),p&&r.jsx("div",{className:"bg-red-900/20 border border-red-700/50 rounded-lg p-3",children:r.jsx("p",{className:"text-sm text-red-400",children:s.find(e=>"error"===e.severity)?.message})})]})};function d(e,t){switch(t.type){case"currency":{let t;let a=e.replace(/[€£$]/g,"").replace(/,/g,"").trim();if(a.includes("million")||a.includes("M")){let s=parseFloat(a.replace(/million|M/g,""));if(isNaN(s))return e;t=1e6*s}else if(a.includes("K")){let s=parseFloat(a.replace("K",""));if(isNaN(s))return e;t=1e3*s}else if(isNaN(t=parseFloat(a)))return e;return t}case"number":{if(e.includes("-")){let t=e.split("-").map(e=>parseInt(e.trim(),10));if(t.some(isNaN))return e;let[a,s]=t;return Math.round((a+s)/2)}let t=parseInt(e,10);return isNaN(t)?e:t}case"boolean":{let t=e.toLowerCase().trim();if("yes"===t||"true"===t||"1"===t)return!0;if("no"===t||"false"===t||"0"===t)return!1;return e}default:return e}}/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,i.Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var m=a(36283),p=a(30361);/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,i.Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),h=({field:e,value:t,onChange:a,errors:s=[],disabled:l=!1})=>{let[i,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)(null),[h,g]=(0,n.useState)(!1),[y,f]=(0,n.useState)(null),b=(0,n.useRef)(null);s.length;let v=s.find(e=>"error"===e.severity)?.message,w=function(e){switch(e.type){case"currency":case"number":return[".xlsx",".xls",".csv",".pdf"];case"text":case"textarea":return[".pdf",".docx",".doc",".txt"];default:return[".pdf",".xlsx",".xls",".csv"]}}(e),j=e=>{let t=[];e.size>10485760&&t.push("File size must be less than 10MB");let a="."+e.name.split(".").pop()?.toLowerCase();return w.includes(a)||t.push(`File type not supported. Supported formats: ${w.join(", ")}`),{valid:0===t.length,errors:t}},N=async t=>{g(!0),f(null);try{await new Promise(e=>setTimeout(e,2e3));let s="revenue"===e.id?5e5:"ebitda"===e.id?15e4:"number_of_employees"===e.id?25:`Extracted from ${t.name}`;a(s,"file_upload"),f(null)}catch(e){f(e instanceof Error?e.message:"File processing failed")}finally{g(!1)}},k=async e=>{let t=j(e);if(!t.valid){f(t.errors.join(", "));return}d(e),f(null),await N(e)},z=()=>{d(null),f(null),a(void 0,"file_upload"),b.current&&(b.current.value="")};return(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(u,{className:"w-4 h-4 text-primary-400"}),(0,r.jsxs)("label",{className:"text-sm font-medium text-white",children:[e.label,e.required&&r.jsx("span",{className:"text-red-400 ml-1",children:"*"})]})]}),e.description&&r.jsx("p",{className:"text-xs text-zinc-400",children:e.description}),!c&&(0,r.jsxs)("div",{onDrop:e=>{e.preventDefault(),o(!1);let t=Array.from(e.dataTransfer.files);t.length>0&&k(t[0])},onDragOver:e=>{e.preventDefault(),o(!0)},onDragLeave:()=>{o(!1)},className:`
            relative border-2 border-dashed rounded-lg p-6 text-center transition-colors cursor-pointer
            ${i?"border-primary-400 bg-primary-600/10":"border-zinc-600 hover:border-zinc-500"}
            ${l?"opacity-50 cursor-not-allowed":""}
          `,onClick:()=>!l&&b.current?.click(),children:[r.jsx("input",{ref:b,type:"file",onChange:e=>{let t=e.target.files;t&&t.length>0&&k(t[0])},accept:w.join(","),disabled:l,className:"hidden"}),r.jsx(m.Z,{className:"w-8 h-8 text-zinc-400 mx-auto mb-2"}),r.jsx("p",{className:"text-sm text-zinc-300 mb-1",children:"Drop your file here or click to browse"}),(0,r.jsxs)("p",{className:"text-xs text-zinc-500",children:["Supported formats: ",w.join(", ")," (max"," ",Math.round(10),"MB)"]})]}),c&&h&&(0,r.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-zinc-800/50 rounded-lg border border-zinc-600/50",children:[r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-primary-500"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm text-white",children:["Processing ",c.name,"..."]}),(0,r.jsxs)("p",{className:"text-xs text-zinc-400",children:["Extracting ",e.label.toLowerCase()," from document"]})]})]}),c&&!h&&!y&&void 0!==t&&(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-green-900/20 rounded-lg border border-green-700/50",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx(p.Z,{className:"w-5 h-5 text-green-400"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm text-white",children:["Successfully processed ",c.name]}),(0,r.jsxs)("p",{className:"text-xs text-zinc-400",children:["Extracted: ",r.jsx("span",{className:"text-green-300",children:function(e,t){return"number"==typeof e?"currency"===t.type?new Intl.NumberFormat("en-US",{style:"currency",currency:"EUR"}).format(e):e.toLocaleString():String(e)}(t,e)})]})]})]}),r.jsx("button",{onClick:z,className:"text-zinc-400 hover:text-zinc-300 text-sm",disabled:l,children:"Remove"})]}),y&&(0,r.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-red-900/20 rounded-lg border border-red-700/50",children:[r.jsx(x,{className:"w-5 h-5 text-red-400"}),(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("p",{className:"text-sm text-red-400",children:"Processing failed"}),r.jsx("p",{className:"text-xs text-zinc-400",children:y})]}),r.jsx("button",{onClick:z,className:"text-zinc-400 hover:text-zinc-300 text-sm",disabled:l,children:"Try again"})]}),e.id&&(0,r.jsxs)("div",{className:"bg-zinc-800/30 rounded-lg p-3 border border-zinc-700/30",children:[r.jsx("p",{className:"text-xs font-medium text-zinc-300 mb-2",children:"\uD83D\uDCA1 What to look for in your file:"}),r.jsx("ul",{className:"text-xs text-zinc-400 space-y-1",children:(function(e){switch(e.id){case"revenue":return['Look for "Revenue", "Sales", "Turnover" in financial statements',"Check income statements or P&L sections","Annual figures are preferred over monthly"];case"ebitda":return['Look for "EBITDA", "Operating Profit", "Earnings Before Interest..."',"Check income statements","Exclude extraordinary items if possible"];case"number_of_employees":return['Look for "Number of Employees", "Headcount", "Staff Count"',"Check company overview or HR sections","Full-time equivalents (FTE) preferred"];default:return[`Look for "${e.label}" in the document`,"Check tables, headers, and key sections","Use the most recent or relevant figures"]}})(e).map((e,t)=>(0,r.jsxs)("li",{children:["• ",e]},t))})]}),v&&r.jsx("p",{className:"text-sm text-red-400",children:v})]})},g=(0,i.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),y=(0,i.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),f=({field:e,value:t,onChange:a,errors:s=[],disabled:l=!1})=>{let[i,o]=(0,n.useState)(""),[c,d]=(0,n.useState)(!1);s.length;let u=s.find(e=>"error"===e.severity)?.message,m=(0,n.useMemo)(()=>{if(!i.trim()||!e.options)return[];let t=i.toLowerCase(),a=[];for(let s of e.options){let e=s.label.toLowerCase(),r=s.value.toLowerCase(),n=0;if(e===t||r===t)n=100;else if(e.startsWith(t)||r.startsWith(t))n=80;else if(e.includes(t)||r.includes(t))n=60;else{let a=t.split(""),s=0;for(let t of a)(e.includes(t)||r.includes(t))&&s++;n=s/a.length*40}n>20&&a.push({option:s,score:n})}return a.sort((e,t)=>t.score-e.score).slice(0,8)},[i,e.options]),p=e=>{a(e,"fuzzy_search"),o(""),d(!1)};return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-white",children:[e.label,e.required&&r.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),e.description&&r.jsx("p",{className:"text-xs text-zinc-400",children:e.description}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("div",{className:"relative",children:[r.jsx(g,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-zinc-400"}),r.jsx("input",{type:"text",value:i,onChange:e=>{o(e.target.value),d(!0)},onFocus:()=>d(!0),placeholder:`Search ${e.label.toLowerCase()}...`,disabled:l,className:"w-full pl-10 pr-4 py-2 bg-zinc-800 border border-zinc-600 rounded-lg text-white placeholder-zinc-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),t&&(0,r.jsxs)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 flex items-center space-x-2",children:[r.jsx("span",{className:"text-xs text-zinc-400 bg-zinc-700 px-2 py-1 rounded",children:(()=>{if(!t||!e.options)return"";let a=e.options.find(e=>e.value===t);return a?a.label:t})()}),r.jsx(y,{className:"w-4 h-4 text-green-400"})]})]}),c&&i.trim()&&m.length>0&&r.jsx("div",{className:"absolute z-50 w-full mt-1 bg-zinc-800 border border-zinc-600 rounded-lg shadow-lg max-h-64 overflow-y-auto",children:m.map(({option:e})=>r.jsx("button",{onClick:()=>p(e.value),disabled:l,className:"w-full px-4 py-3 text-left hover:bg-zinc-700 focus:bg-zinc-700 focus:outline-none transition-colors border-b border-zinc-700/50 last:border-b-0",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("div",{className:"text-white font-medium",children:e.label}),e.description&&r.jsx("div",{className:"text-xs text-zinc-400 mt-1",children:e.description})]}),t===e.value&&r.jsx(y,{className:"w-4 h-4 text-primary-400"})]})},e.value))}),c&&i.trim()&&0===m.length&&(0,r.jsxs)("div",{className:"absolute z-50 w-full mt-1 bg-zinc-800 border border-zinc-600 rounded-lg shadow-lg p-4 text-center",children:[(0,r.jsxs)("p",{className:"text-zinc-400 text-sm",children:['No matches found for "',i,'"']}),(0,r.jsxs)("button",{onClick:()=>p(i),className:"mt-2 px-3 py-1 bg-primary-600 text-white text-xs rounded hover:bg-primary-700 transition-colors",children:['Use "',i,'" anyway']})]})]}),!i.trim()&&e.options&&e.options.length>0&&(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("p",{className:"text-xs text-zinc-500",children:"Popular options:"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:e.options.slice(0,6).map(e=>r.jsx("button",{onClick:()=>p(e.value),disabled:l,className:"px-3 py-1 bg-zinc-800/50 hover:bg-zinc-700/50 text-sm text-zinc-300 rounded-lg border border-zinc-600/50 hover:border-zinc-500/50 transition-colors",children:e.label},e.value))})]}),u&&r.jsx("p",{className:"text-sm text-red-400",children:u})]})},b=({field:e,value:t,onChange:a,errors:s=[],disabled:n=!1,autoFocus:l=!1})=>{let i=s.length>0,o=s.find(e=>"error"===e.severity)?.message;return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-white",children:[e.label,e.required&&r.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),e.description&&r.jsx("p",{className:"text-sm text-zinc-400",children:e.description}),r.jsx(v,{field:e,value:t??"",onChange:e=>{a(e,"manual_form")},disabled:n,autoFocus:l,hasErrors:i}),o&&r.jsx("p",{className:"text-sm text-red-400",children:o})]})},v=({field:e,value:t,onChange:a,disabled:s=!1,autoFocus:n=!1,hasErrors:l=!1})=>{let i=`
    w-full px-3 py-2 bg-zinc-800 border rounded-lg text-white placeholder-zinc-400
    focus:outline-none focus:ring-2 focus:ring-primary-500
    ${l?"border-red-500":"border-zinc-600"}
    ${s?"opacity-50 cursor-not-allowed":""}
  `;switch(e.type){case"text":case"textarea":{let l="string"==typeof t?t:String(t||"");if("textarea"===e.type)return r.jsx("textarea",{value:l,onChange:e=>a(e.target.value),placeholder:e.placeholder,disabled:s,autoFocus:n,rows:4,className:i});return r.jsx("input",{type:"text",value:l,onChange:e=>a(e.target.value),placeholder:e.placeholder,disabled:s,autoFocus:n,className:i})}case"number":case"currency":{let l="number"==typeof t?t:t?Number(t):"";return r.jsx("input",{type:"number",value:l,onChange:t=>a("currency"===e.type?parseFloat(t.target.value)||0:parseInt(t.target.value)||0),placeholder:e.placeholder,disabled:s,autoFocus:n,min:e.validation?.find(e=>"min"===e.type)?.value,max:e.validation?.find(e=>"max"===e.type)?.value,className:i})}case"select":{let l="string"==typeof t?t:String(t||"");return(0,r.jsxs)("select",{value:l,onChange:e=>a(e.target.value),disabled:s,autoFocus:n,className:i,children:[r.jsx("option",{value:"",children:e.placeholder||`Select ${e.label}`}),e.options?.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))]})}case"boolean":return(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("input",{type:"checkbox",checked:!!t,onChange:e=>a(e.target.checked),disabled:s,autoFocus:n,className:"w-4 h-4 text-primary-600 bg-zinc-800 border-zinc-600 rounded focus:ring-primary-500"}),r.jsx("span",{className:"text-sm text-zinc-300",children:"Yes"})]});case"percentage":{let l="number"==typeof t?100*t:t?Number(t):"";return(0,r.jsxs)("div",{className:"relative",children:[r.jsx("input",{type:"number",value:l,onChange:e=>a((parseFloat(e.target.value)||0)/100),placeholder:e.placeholder,disabled:s,autoFocus:n,min:"0",max:"100",className:i}),r.jsx("span",{className:"absolute right-3 top-2 text-zinc-400",children:"%"})]})}default:{let l="string"==typeof t?t:String(t||"");return r.jsx("input",{type:"text",value:l,onChange:e=>a(e.target.value),placeholder:e.placeholder,disabled:s,autoFocus:n,className:i})}}};var w=a(1572);let j=({field:e,value:t,onChange:a,errors:s=[],disabled:n=!1})=>{s.length;let l=s.find(e=>"error"===e.severity)?.message,i=e.suggestions||[];return 0===i.length?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-white",children:[e.label,e.required&&r.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),r.jsx("input",{type:"text",value:"string"==typeof t?t:"",onChange:e=>a(e.target.value,"suggestion"),placeholder:e.placeholder,disabled:n,className:"w-full px-3 py-2 bg-zinc-800 border border-zinc-600 rounded-lg text-white placeholder-zinc-400 focus:outline-none focus:ring-2 focus:ring-primary-500"}),l&&r.jsx("p",{className:"text-sm text-red-400",children:l})]}):(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(w.Z,{className:"w-4 h-4 text-primary-400"}),(0,r.jsxs)("label",{className:"text-sm font-medium text-white",children:[e.label,e.required&&r.jsx("span",{className:"text-red-400 ml-1",children:"*"})]})]}),e.description&&r.jsx("p",{className:"text-xs text-zinc-400",children:e.description}),r.jsx("div",{className:"grid grid-cols-2 gap-2",children:i.map((s,l)=>r.jsx("button",{onClick:()=>a(N(s,e),"suggestion"),disabled:n,className:`
              px-3 py-2 text-left rounded-lg border transition-all duration-200 text-sm
              ${t===N(s,e)?"bg-primary-600 border-primary-500 text-white shadow-lg":"bg-zinc-800/50 border-zinc-600/50 text-zinc-300 hover:bg-zinc-700/50 hover:border-zinc-500/50"}
              ${n?"opacity-50 cursor-not-allowed":"cursor-pointer"}
            `,children:s},l))}),r.jsx("div",{className:"relative",children:r.jsx("input",{type:"text",value:"string"!=typeof t||i.includes(t)?"":t,onChange:e=>a(e.target.value,"suggestion"),placeholder:`Or enter custom ${e.label.toLowerCase()}...`,disabled:n,className:"w-full px-3 py-2 bg-zinc-800/50 border border-zinc-600/50 rounded-lg text-white placeholder-zinc-500 focus:outline-none focus:ring-2 focus:ring-primary-500/50 focus:border-primary-500/50 text-sm"})}),l&&r.jsx("p",{className:"text-sm text-red-400",children:l})]})};function N(e,t){switch(t.type){case"number":{if(e.includes("-")){let t=e.split("-").map(e=>e.trim()),a=t.map(e=>parseInt(e,10));if(2===t.length&&a.every(e=>!isNaN(e))){let[e,t]=a;return Math.round((e+t)/2)}}let t=parseInt(e.replace(/\D/g,""),10);return isNaN(t)?e:t}case"currency":{if(e.includes("-")){let t=e.split("-").map(e=>e.trim());if(2===t.length){let e=k(t[0]),a=k(t[1]);if(null!==e&&null!==a)return Math.round((e+a)/2)}}let t=k(e);return null!==t?t:e}case"boolean":{let t=e.toLowerCase().trim();if("yes"===t||"true"===t||"1"===t)return!0;if("no"===t||"false"===t||"0"===t)return!1;return e}default:return e}}function k(e){let t=e.replace(/[€£$]/g,"").trim(),a=1,s=t;t.includes("K")?(a=1e3,s=t.replace("K","")):t.includes("M")&&(a=1e6,s=t.replace("M",""));let r=parseFloat(s.replace(/,/g,""));return isNaN(r)?null:r*a}let z=e=>{let{context:t}=e,a=(e=>{switch(e){case"manual_form":default:return b;case"conversational":return c;case"suggestion":return j;case"fuzzy_search":return f;case"file_upload":return h}})(t.method);return r.jsx(a,{...e})},C=({method:e="manual_form",onDataCollected:t,onProgressUpdate:a,onComplete:l,initialData:i={},disabled:o=!1,className:c=""})=>{let[d,u]=(0,n.useState)(()=>{let e=new Map;return Object.entries(i).forEach(([t,a])=>{if(null!=a){let s={fieldId:t,value:a,method:"manual_form",confidence:.8,source:"initial_data",timestamp:new Date};e.set(t,s)}}),e}),m=(0,n.useCallback)((e,r)=>{let n={fieldId:e,value:r,method:"manual_form",confidence:1,source:"user_input",timestamp:new Date};u(t=>{let a=new Map(t);return a.set(e,n),a});let i=Array.from(d.values());i.push(n),t?.(i);let o=Object.values(s),c=i.length,m=o.length;a?.({overallProgress:c/m,completedFields:c,totalFields:m});let p=o.filter(e=>e.required);p.filter(e=>i.some(t=>t.fieldId===e.id&&void 0!==t.value&&""!==t.value)).length===p.length&&l?.(i)},[d,t,a,l]),p=Object.values(s),x=d.size,h=p.length;return(0,r.jsxs)("div",{className:`space-y-6 ${c}`,children:[(0,r.jsxs)("div",{className:"bg-zinc-800/50 rounded-lg p-4 border border-zinc-700/50",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("h3",{className:"text-sm font-medium text-white",children:"Complete the Form"}),(0,r.jsxs)("span",{className:"text-xs text-zinc-400",children:[x,"/",h," fields"]})]}),r.jsx("div",{className:"w-full bg-zinc-700 rounded-full h-2",children:r.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:`${x/h*100}%`}})})]}),r.jsx("div",{className:"space-y-4",children:p.map(e=>r.jsx(z,{field:e,value:d.get(e.id)?.value,onChange:t=>m(e.id,t),errors:[],context:{session:{id:"manual-form-session",fields:[],responses:new Map,completedFieldIds:new Set,method:"manual_form",startedAt:new Date,lastActivity:new Date,isComplete:!1,validationErrors:new Map},previousResponses:Array.from(d.values()),method:"manual_form"},disabled:o},e.id))})]})}},34791:(e,t,a)=>{a.r(t),a.d(t,{ValuationFlow:()=>p});var s=a(10326),r=a(17577),n=a(14118),l=a(27048),i=a(97810),o=a(45055),c=a(33741);let d=(0,r.lazy)(()=>a.e(815).then(a.bind(a,46815)).then(e=>({default:e.Results}))),u=(0,r.lazy)(()=>a.e(661).then(a.bind(a,65661)).then(e=>({default:e.ConversationalLayout}))),m=({message:e="Loading..."})=>s.jsx("div",{className:"flex items-center justify-center p-8",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600"}),s.jsx("span",{className:"text-zinc-600",children:e})]})}),p=({reportId:e,flowType:t,onComplete:a,initialQuery:n=null,autoSend:l=!1})=>"conversational"===t?s.jsx(r.Suspense,{fallback:s.jsx(m,{message:"Loading conversational flow..."}),children:s.jsx(u,{reportId:e,onComplete:a,initialQuery:n,autoSend:l})}):s.jsx(x,{reportId:e,onComplete:a}),x=({reportId:e,onComplete:t})=>{let{result:u,isCalculating:p,calculateValuation:x,setCollectedData:h}=(0,o.useValuationStore)(),{user:g}=(0,i.a)(),y=(0,r.useCallback)(e=>{h(e)},[h]),f=(0,r.useCallback)(async t=>{h(t);try{await x()}catch(t){c.a.error("Valuation calculation failed",{error:t,reportId:e})}},[h,x,e]),b=(0,r.useCallback)(e=>{c.a.debug("Manual flow progress update",{progress:e.overallProgress,completedFields:e.completedFields,totalFields:e.totalFields})},[]);return(0,s.jsxs)("div",{className:"h-full flex flex-col",children:[s.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:s.jsx(n.hK,{method:"manual_form",onDataCollected:y,onProgressUpdate:b,onComplete:f})}),s.jsx(l.x,{onRefresh:()=>window.location.reload(),onDownload:async()=>{if(u)try{let{DownloadService:e}=await Promise.all([a.e(92),a.e(509)]).then(a.bind(a,75509));await e.downloadPDF(u,{format:"pdf",filename:`valuation-${Date.now()}.pdf`})}catch(t){c.a.error("PDF download failed",{error:t,reportId:e})}},onFullScreen:()=>{},isGenerating:p,user:g,valuationName:"Manual Valuation",valuationId:u?.valuation_id,activeTab:"preview",onTabChange:()=>{}}),u&&s.jsx("div",{className:"border-t border-gray-200",children:s.jsx(r.Suspense,{fallback:s.jsx(m,{message:"Loading results..."}),children:s.jsx(d,{})})})]})};x.displayName="ManualFlow",p.displayName="ValuationFlow"}};