"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[892],{65892:function(e,a,l){l.r(a),l.d(a,{ValuationFlow:function(){return m}});var n=l(57437),s=l(2265),o=l(30761),t=l(38691),i=l(69419);let r=(0,s.lazy)(()=>l.e(595).then(l.bind(l,70595)).then(e=>({default:e.Results}))),d=(0,s.lazy)(()=>Promise.all([l.e(4),l.e(216),l.e(493),l.e(649),l.e(985),l.e(519),l.e(480)]).then(l.bind(l,5881)).then(e=>({default:e.ConversationalLayout}))),c=(0,s.lazy)(()=>Promise.all([l.e(4),l.e(493),l.e(519)]).then(l.bind(l,519)).then(e=>({default:e.ValuationToolbar}))),u=(0,s.lazy)(()=>Promise.all([l.e(4),l.e(985)]).then(l.bind(l,9985)).then(e=>({default:e.DataCollection}))),f=e=>{let{message:a="Loading..."}=e;return(0,n.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600"}),(0,n.jsx)("span",{className:"text-zinc-600",children:a})]})})},m=e=>{let{reportId:a,flowType:l,onComplete:o,initialQuery:t=null,autoSend:i=!1}=e;return"conversational"===l?(0,n.jsx)(s.Suspense,{fallback:(0,n.jsx)(f,{message:"Loading conversational flow..."}),children:(0,n.jsx)(d,{reportId:a,onComplete:o,initialQuery:t,autoSend:i})}):(0,n.jsx)(h,{reportId:a,onComplete:o})},h=e=>{let{reportId:a,onComplete:d}=e,{result:m,isCalculating:h,calculateValuation:p,setCollectedData:x}=(0,t.useValuationStore)(),{user:b}=(0,o.a)(),j=(0,s.useCallback)(e=>{x(e)},[x]),v=(0,s.useCallback)(async e=>{x(e);try{await p()}catch(e){i.a.error("Valuation calculation failed",{error:e,reportId:a})}},[x,p,a]),w=(0,s.useCallback)(e=>{i.a.debug("Manual flow progress update",{progress:e.overallProgress,completedFields:e.completedFields,totalFields:e.totalFields})},[]);return(0,n.jsxs)("div",{className:"h-full flex flex-col",children:[(0,n.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:(0,n.jsx)(s.Suspense,{fallback:(0,n.jsx)(f,{message:"Loading data collection..."}),children:(0,n.jsx)(u,{method:"manual_form",onDataCollected:j,onProgressUpdate:w,onComplete:v})})}),(0,n.jsx)(s.Suspense,{fallback:(0,n.jsx)(f,{message:"Loading toolbar..."}),children:(0,n.jsx)(c,{onRefresh:()=>window.location.reload(),onDownload:async()=>{if(m)try{let{DownloadService:e}=await Promise.all([l.e(216),l.e(493),l.e(673)]).then(l.bind(l,55673));await e.downloadPDF(m,{format:"pdf",filename:"valuation-".concat(Date.now(),".pdf")})}catch(e){i.a.error("PDF download failed",{error:e,reportId:a})}},onFullScreen:()=>{},isGenerating:h,user:b,valuationName:"Manual Valuation",valuationId:null==m?void 0:m.valuation_id,activeTab:"preview",onTabChange:()=>{}})}),m&&(0,n.jsx)("div",{className:"border-t border-gray-200",children:(0,n.jsx)(s.Suspense,{fallback:(0,n.jsx)(f,{message:"Loading results..."}),children:(0,n.jsx)(r,{})})})]})};h.displayName="ManualFlow",m.displayName="ValuationFlow"}}]);